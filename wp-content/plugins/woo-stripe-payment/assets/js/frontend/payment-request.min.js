!function(a,i){var t;a(document.body).is(".single-product")&&((t=function(){i.BaseGateway.call(this,wc_stripe_payment_request_params),window.addEventListener("hashchange",this.hashchange.bind(this)),this.old_qty=this.get_quantity()}).prototype=a.extend({},i.BaseGateway.prototype,i.ProductGateway.prototype,i.PaymentRequest.prototype),t.prototype.initialize=function(){if(!a(this.container).length)return setTimeout(this.initialize.bind(this),1e3);i.ProductGateway.call(this),i.PaymentRequest.prototype.initialize.call(this)},t.prototype.canMakePayment=function(){i.PaymentRequest.prototype.canMakePayment.apply(this,arguments).then(function(){a(document.body).on("change",'[name="quantity"]',this.add_to_cart.bind(this)),a(this.container).parent().parent().addClass("active"),this.is_variable_product()?this.variable_product_selected()?(this.cart_calculation(this.get_product_data().variation.variation_id),a(this.container).removeClass("processingFoundVariation")):this.disable_payment_button():this.cart_calculation()}.bind(this))},t.prototype.add_to_cart=function(t){this.disable_payment_button(),this.old_qty=this.get_quantity();var e=this.get_product_data().variation;this.is_variable_product()&&!this.variable_product_selected()||this.cart_calculation(e.variation_id).then(function(){this.is_variable_product()&&a(this.container).is(".processingFoundVariation")?(this.createPaymentRequest(),this.createPaymentRequestButton(),i.PaymentRequest.prototype.canMakePayment.apply(this,arguments).then(function(){this.enable_payment_button(),a(this.container).removeClass("processingFoundVariation")}.bind(this))):this.enable_payment_button()}.bind(this))},t.prototype.cart_calculation=function(){return i.ProductGateway.prototype.cart_calculation.apply(this,arguments).then(function(){this.paymentRequest.update(this.get_payment_request_update({total:{pending:!1}}))}.bind(this))["catch"](function(){}.bind(this))},t.prototype.create_button=function(){a("#wc-stripe-payment-request-container").empty(),i.PaymentRequest.prototype.create_button.apply(this,arguments),this.$button=a("#wc-stripe-payment-request-container")},t.prototype.button_click=function(t){this.$button.is(".disabled")?t.preventDefault():0==this.get_quantity()&&(t.preventDefault(),this.submit_error(this.params.messages.invalid_amount))},t.prototype.found_variation=function(){a(this.container).addClass("processingFoundVariation"),i.ProductGateway.prototype.found_variation.apply(this,arguments)},t.prototype.block=function(){a.blockUI({message:this.adding_to_cart?this.params.messages.add_to_cart:null,overlayCSS:{background:"#fff",opacity:.6}})}),a(document.body).is(".woocommerce-cart")&&((t=function(){i.BaseGateway.call(this,wc_stripe_payment_request_params),window.addEventListener("hashchange",this.hashchange.bind(this))}).prototype=a.extend({},i.BaseGateway.prototype,i.CartGateway.prototype,i.PaymentRequest.prototype),t.prototype.initialize=function(){i.CartGateway.call(this),i.PaymentRequest.prototype.initialize.call(this)},t.prototype.canMakePayment=function(){i.PaymentRequest.prototype.canMakePayment.apply(this,arguments).then(function(){a(this.container).addClass("active").parent().addClass("active")}.bind(this))},t.prototype.updated_html=function(){a(this.container).length||(this.can_pay=!1),this.can_pay&&this.initialize()},t.prototype.button_click=function(t){this.paymentRequest.update(this.get_payment_request_update({total:{pending:!1}}))},t.prototype.cart_emptied=function(t){this.can_pay=!1}),a(document.body).is(".woocommerce-checkout")&&((t=function(){i.BaseGateway.call(this,wc_stripe_payment_request_params),window.addEventListener("hashchange",this.hashchange.bind(this))}).prototype=a.extend({},i.BaseGateway.prototype,i.CheckoutGateway.prototype,i.PaymentRequest.prototype),t.prototype.initialize=function(){i.CheckoutGateway.call(this),a("form.checkout").on("change",".form-row:not(.address-field) .input-text",this.update_payment_request.bind(this)),a(this.container).length&&i.PaymentRequest.prototype.initialize.call(this)},t.prototype.canMakePayment=function(){i.PaymentRequest.prototype.canMakePayment.apply(this,arguments).then(function(){var t;this.banner_enabled()&&(a(this.banner_container).empty().show().append('<div id="wc-stripe-payment-request-banner"></div>'),a(this.banner_container).show().parent().parent().addClass("active"),(t=this.stripe.elements().create("paymentRequestButton",{paymentRequest:this.paymentRequest,style:{paymentRequestButton:{type:this.params.button.type,theme:this.params.button.theme,height:this.params.button.height}}})).on("click",this.banner_checkout.bind(this)),t.mount("#wc-stripe-payment-request-banner"))}.bind(this))},t.prototype.create_button=function(){this.$button&&this.$button.remove(),this.$button=a('<div id="wc-stripe-payment-request-container"></div>'),a("#place_order").after(this.$button),i.PaymentRequest.prototype.create_button.call(this),this.trigger_payment_method_selected()},t.prototype.updated_checkout=function(){a(this.container).length&&i.PaymentRequest.prototype.initialize.call(this)},t.prototype.banner_checkout=function(t){this.set_payment_method(this.gateway_id),this.set_use_new_option(!0)},t.prototype.on_token_received=function(){i.CheckoutGateway.prototype.on_token_received.apply(this,arguments),this.fields.toFormFields(),this.payment_request_options.requestShipping&&this.maybe_set_ship_to_different(),this.checkout_fields_valid()&&this.get_form().submit()},t.prototype.update_payment_request=function(){a(this.container).length&&i.PaymentRequest.prototype.initialize.call(this)}),new t}(jQuery,window.wc_stripe);